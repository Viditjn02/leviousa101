<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Paragon Connect Portal</title>
</head>
<body>
    <h1>Paragon Connect Portal Test</h1>
    <p>This page will test the Paragon Connect Portal integration.</p>
    
    <button id="testConnect">Test Gmail Connection</button>
    <div id="result"></div>

    <!-- Load Paragon SDK -->
    <script src="https://cdn.useparagon.com/latest/sdk/index.js"></script>
    
    <script>
        async function testParagonConnect() {
            const resultDiv = document.getElementById('result');
            
            try {
                // Use the actual project ID from the .env file
                const projectId = "db5e019e-0558-4378-93de-f212a73e0606";
                
                // For testing, we'll create a simple JWT token
                // In production, this should come from your backend
                const userToken = "test-user-token"; // This needs to be a proper JWT
                
                resultDiv.innerHTML = "Authenticating with Paragon...";
                
                // Authenticate with Paragon
                await paragon.authenticate(projectId, userToken);
                
                resultDiv.innerHTML = "Authentication successful! Opening Connect Portal...";
                
                // Try to connect to Gmail - this should trigger the Connect Portal
                paragon.connect("gmail", {
                    onSuccess: () => {
                        resultDiv.innerHTML = "‚úÖ Gmail connection successful!";
                    },
                    onError: (error) => {
                        resultDiv.innerHTML = `‚ùå Error: ${error.message || error}`;
                        console.error("Paragon Connect Error:", error);
                    },
                    onOpen: () => {
                        resultDiv.innerHTML = "üöÄ Connect Portal opened...";
                    },
                    onClose: () => {
                        resultDiv.innerHTML = "Connect Portal closed.";
                    }
                });
                
            } catch (error) {
                resultDiv.innerHTML = `‚ùå Authentication Error: ${error.message}`;
                console.error("Paragon Auth Error:", error);
            }
        }
        
        document.getElementById('testConnect').addEventListener('click', testParagonConnect);
    </script>
</body>
</html>